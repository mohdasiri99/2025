<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>ููุญุฉ ููุชุดููุฌ ุงุญุชุฑุงููุฉ โ GROW</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">

<style>
body{font-family:'Cairo',sans-serif;background:#f1f5f9}
.step{display:none}
.step.active{display:block}
.btn{background:#4f46e5;color:white;padding:12px 26px;border-radius:14px;font-weight:800}
.card{background:white;border-radius:20px;box-shadow:0 10px 30px rgba(0,0,0,.08)}
</style>
</head>

<body class="text-slate-800">

<!-- DASHBOARD -->
<div id="dashboard" class="max-w-5xl mx-auto my-10 card p-8">
<h1 class="text-3xl font-extrabold text-indigo-900 mb-6 text-center">
ููุญุฉ ุชุญูู ุฌูุณุงุช ุงูููุชุดููุฌ
</h1>

<div class="grid md:grid-cols-3 gap-6 mb-6">
<div class="bg-indigo-50 p-4 rounded-xl text-center">
<p class="text-sm font-bold">ุนุฏุฏ ุงูุฌูุณุงุช</p>
<p id="countSessions" class="text-3xl font-extrabold text-indigo-700">0</p>
</div>

<div class="bg-emerald-50 p-4 rounded-xl text-center">
<p class="text-sm font-bold">ุขุฎุฑ ุฌูุณุฉ</p>
<p id="lastSession" class="text-sm font-bold text-emerald-700">โ</p>
</div>

<div class="bg-sky-50 p-4 rounded-xl text-center">
<p class="text-sm font-bold">ุงูุฌุงูุฒูุฉ</p>
<p class="text-sm font-extrabold text-sky-700">ุฌุงูุฒ ููุจุฏุก</p>
</div>
</div>

<button onclick="startSession()" class="btn mx-auto block mb-6">
๐ ุจุฏุก ุฌูุณุฉ ุฌุฏูุฏุฉ
</button>

<h2 class="font-extrabold mb-3">๐ ุณุฌู ุงูุฅูุฌุงุฒ</h2>
<ul id="logList" class="text-sm space-y-2"></ul>
</div>

<!-- SESSION -->
<div id="session" class="max-w-4xl mx-auto my-10 card p-8 hidden">

<h1 class="text-2xl font-extrabold text-indigo-900 text-center mb-4">
ุฌูุณุฉ ููุชุดููุฌ โ ูููุฐุฌ GROW
</h1>

<!-- GLOBAL TIMER -->
<div class="mb-6">
<div class="flex justify-between text-xs font-bold">
<span>โณ ุฒูู ุงูุฌูุณุฉ</span>
<span id="globalTime">45:00</span>
</div>
<div class="h-2 bg-slate-200 rounded">
<div id="globalBar" class="h-2 bg-indigo-600 rounded" style="width:100%"></div>
</div>
</div>

<!-- STEP TIMER -->
<div class="mb-6">
<div class="flex justify-between text-xs font-bold">
<span id="stepTitle">ุงููุฑุญูุฉ ุงูุญุงููุฉ</span>
<span id="stepTime">00:00</span>
</div>
<div class="h-2 bg-slate-200 rounded">
<div id="stepBar" class="h-2 bg-emerald-500 rounded" style="width:100%"></div>
</div>
</div>

<!-- STEPS -->
<div id="step1" class="step active">
<h2 class="font-extrabold text-indigo-700 mb-2">๐ฏ ุงููุฏู</h2>
<textarea id="goal" class="w-full border rounded-xl p-3" placeholder="ูุง ูุฏููุ"></textarea>
<button onclick="nextStep(1)" class="btn mt-4">ุงูุชุงูู</button>
</div>

<div id="step2" class="step">
<h2 class="font-extrabold text-indigo-700 mb-2">๐ ุงููุงูุน</h2>
<textarea id="reality" class="w-full border rounded-xl p-3" placeholder="ุฃูู ุฃูุช ุงูุขูุ"></textarea>
<button onclick="nextStep(2)" class="btn mt-4">ุงูุชุงูู</button>
</div>

<div id="step3" class="step">
<h2 class="font-extrabold text-indigo-700 mb-2">๐ก ุงูุฎูุงุฑุงุช</h2>
<textarea id="options" class="w-full border rounded-xl p-3" placeholder="ูุง ุงูุฎูุงุฑุงุชุ"></textarea>
<button onclick="nextStep(3)" class="btn mt-4">ุงูุชุงูู</button>
</div>

<div id="step4" class="step">
<h2 class="font-extrabold text-indigo-700 mb-2">๐ ุงูุงูุชุฒุงู</h2>
<textarea id="action" class="w-full border rounded-xl p-3" placeholder="ูุง ุฃูู ุฎุทูุฉุ"></textarea>
<textarea id="risk" class="w-full border rounded-xl p-3 mt-2" placeholder="ูุงุฐุง ูู ูู ุชููุฐุ"></textarea>
<button onclick="finishSession()" class="btn mt-4">ุฅููุงุก ุงูุฌูุณุฉ</button>
</div>

</div>

<script>
/* -------- Dashboard -------- */
function loadDashboard(){
  let log=JSON.parse(localStorage.getItem("growLog")||"[]");
  countSessions.textContent=log.length;
  lastSession.textContent=log.length?log[log.length-1].date:"โ";
  logList.innerHTML="";
  log.forEach(s=>{
    let li=document.createElement("li");
    li.textContent=`๐ ${s.date} โ ๐ฏ ${s.goal}`;
    logList.appendChild(li);
  });
}
loadDashboard();

function startSession(){
  dashboard.classList.add("hidden");
  session.classList.remove("hidden");
  startGlobalTimer();
  startStepTimer(0);
}

/* -------- Steps -------- */
let currentStep=1;
const steps=[
{title:"๐ฏ ุงููุฏู",time:600},
{title:"๐ ุงููุงูุน",time:600},
{title:"๐ก ุงูุฎูุงุฑุงุช",time:600},
{title:"๐ ุงูุงูุชุฒุงู",time:600}
];

function nextStep(n){
  document.getElementById(`step${n}`).classList.remove("active");
  document.getElementById(`step${n+1}`).classList.add("active");
  currentStep++;
  startStepTimer(currentStep-1);
}

/* -------- Timers -------- */
let global=45*60;
let stepRemain=0;
let stepInterval;

function startGlobalTimer(){
  setInterval(()=>{
    if(global<=0)return;
    global--;
    let m=Math.floor(global/60);
    let s=global%60;
    globalTime.textContent=`${m}:${s.toString().padStart(2,"0")}`;
    globalBar.style.width=(global/(45*60))*100+"%";
  },1000);
}

function startStepTimer(i){
  clearInterval(stepInterval);
  stepRemain=steps[i].time;
  stepTitle.textContent=steps[i].title;

  stepInterval=setInterval(()=>{
    if(stepRemain<=0)return;
    stepRemain--;
    let m=Math.floor(stepRemain/60);
    let s=stepRemain%60;
    stepTime.textContent=`${m}:${s.toString().padStart(2,"0")}`;
    stepBar.style.width=(stepRemain/steps[i].time)*100+"%";
  },1000);
}

/* -------- Finish -------- */
function finishSession(){
  let log=JSON.parse(localStorage.getItem("growLog")||"[]");
  log.push({
    date:new Date().toLocaleDateString('ar-SA'),
    goal:goal.value
  });
  localStorage.setItem("growLog",JSON.stringify(log));
  location.reload();
}
</script>

</body>
</html>
